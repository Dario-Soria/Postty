# Prompt Comparison: GUI vs Test (Perfect Result)

## Overview

**GUI Result**: `generated-images/1767885671764_nanobanana_base.png` ❌ (poor text)  
**Test Result**: `test/results/agent_1767880721871.png` ✅ (perfect text)

---

## Key Differences Found

### 1. USER REQUEST (Intent) - **MAJOR DIFFERENCE**

**GUI Prompt:**
```
USER REQUEST: Photorealistic product advertisement. A woman wearing black studded leather boots (from the user's product image) is elegantly positioned on a luxurious, sun-drenched tennis court. She is calmly reading a newspaper. The scene is imbued with a warm, luxurious, and serene atmosphere, mimicking the selected reference image. The focus is on the woman and her boots, with the boots clearly visible from toe to top. Full-length shot, ensuring the boots are fully shown as the hero product. The composition provides clear space at the top for a text overlay. High-quality, fashion editorial photography.
```

**Test Prompt (Perfect):**
```
USER REQUEST: Professional fashion photography. A sophisticated woman wearing black leather knee-high boots with buckles (the hero product) from the user's uploaded image, sitting gracefully on a pristine green tennis court, reading a newspaper. The composition is calm and luxurious. Full-length view of the woman, with the boots clearly visible and extending to the ground. Soft, warm natural lighting creates an elegant, serene ambiance, in line with a luxurious and calm mood. Shallow depth of field. Clear space at the top 20% for text overlay, ensuring the full figure and boots are captured without cropping. The image has a clean, premium aesthetic.
```

**Analysis:**
- **Test uses**: "Professional fashion photography", "sophisticated woman", "sitting gracefully", "Soft, warm natural lighting", "Shallow depth of field", "top 20% for text overlay"
- **GUI uses**: "Photorealistic product advertisement", "elegantly positioned", "sun-drenched", "scene is imbued with", "mimicking the selected reference image"

The test prompt has MORE SPECIFIC photography instructions that lead to better composition.

---

### 2. Text 1 Capitalization - **MINOR DIFFERENCE**

**GUI:**
```
Text 1: "Botas "El Uli"
```

**Test:**
```
Text 1: "Botas "el Uli"
```

GUI has capital "E", test has lowercase "e".

---

### 3. Product Colors - **DIFFERENT**

**GUI:**
```
PRODUCT DOMINANT COLORS: #201E1D, #EDEBE6, #C3C2C0
```

**Test:**
```
PRODUCT DOMINANT COLORS: #F6F4EF, #2E2F31, #B2B1AE
```

These are different color palettes being sent.

---

### 4. Text 2 Field Order - **MINOR**

**GUI:**
```
Text 2: "50% off en toda la tienda"
- Typography: script elegant
- Weight: regular
- Case: normal
- Color: black
- Vertical Position: 45% from top edge
- Size: medium (relative to canvas)
- Alignment: center
- Letter Spacing: normal
- Spacing: tight (5-10% gap) gap from headline above
```

**Test:**
```
Text 2: "50% off en toda la tienda"
- Typography: script elegant
- Weight: regular
- Color: black
- Vertical Position: 45% from top edge
- Spacing: tight (5-10% gap) gap from headline above
- Size: medium (relative to canvas)
- Alignment: center
- Letter Spacing: normal
```

Different order but same information.

---

## Root Cause Analysis

### ✅ Typography Format - FIXED
The typography format is now correct in both:
- GUI: `serif elegant (thin strokes, flowing style)` ✅
- Test: `serif elegant (thin strokes, flowing style)` ✅

### ⚠️ USER REQUEST - DIFFERENT SOURCE
The USER REQUEST (intent) is **dramatically different** between GUI and test. This is the main issue.

**Where does this come from?**
1. **GUI flow**: Generated by the Agent (Python script) via API call to `/pipeline`
2. **Test flow**: Manually written in `test/test-generate.ts`

The test has a manually crafted, optimized prompt that includes specific photography terms like:
- "Shallow depth of field"
- "Soft, warm natural lighting"
- "top 20% for text overlay"
- "sitting gracefully"
- "pristine green tennis court"

The GUI version is generated dynamically by the Agent and lacks these specific photography instructions.

---

## Recommended Fix

The issue is NOT in the typography extraction or the `buildFontDescription()` function (that's now fixed).

The issue is in **how the USER REQUEST (intent) is generated**. We need to:

1. **Option A**: Improve the Agent's prompt generation to include more specific photography instructions
2. **Option B**: Enhance the `prompt.md` template with better default photography instructions
3. **Option C**: Add photography guidelines to the SQLite reference data and inject them into the prompt

The typography is now correctly formatted, but the overall scene composition instructions are too generic in the GUI flow.

